{
  "stackName": "etl",
  "clusterPrefix": "merlin-local",
  "dockerComposeYaml": {
    "version": "3.4",
    "networks": {
      "default": {
        "external": {
          "name": "merlin_net"
        }
      }
    },
    "volumes": {
      "hadoop-datavolume": {
        "driver": "local",
        "driver_opts": {
          "type": "nfs",
          "device": ":/var/nfs/merlin",
          "o": "rw,addr=192.168.104.32,proto=tcp,async,soft,nolock"
        }
      },
      "hadoop-logvolume": {
        "driver": "local",
        "driver_opts": {
          "type": "nfs",
          "device": ":/var/nfs/merlin_logs",
          "o": "rw,addr=192.168.104.32,proto=tcp,async,soft,nolock"
        }
      }
    },
    "services": {

      "namenode": {
        "image": "docker-registry.parrot-rp.keyw:5000/hadoop-base-alpine:0.07.13",
        "environment": [
          "HADOOP_MACHINE_ROLE=namenode"
        ],
        "deploy": {
          "replicas": 1,
          "restart_policy": {
            "condition": "on-failure"
          },
          "placement": {
            "constraints": [
              "node.role == manager"
            ]
          },
          "labels": [
            "traefik.enable=true",
            "traefik.port=8088",
            "traefik.backend=namenode",
            "traefik.frontend.rule=Host: namenode.vbox.keyw"
          ]
        },
        "volumes": [
          {
            "type": "volume",
            "source": "hadoop-datavolume",
            "target": "/mnt/merlin",
            "volume": {
              "nocopy": true
            }
          },
          {
            "type": "volume",
            "source": "hadoop-logvolume",
            "target": "/mnt/logs",
            "volume": {
              "nocopy": true
            }
          }
        ]
      },
      "datanode": {
        "image": "docker-registry.parrot-rp.keyw:5000/hadoop-base-alpine:0.07.13",
        "environment": [
          "HADOOP_MACHINE_ROLE=datanode"
        ],
        "deploy": {
          "replicas": 1,
          "restart_policy": {
            "condition": "on-failure"
          },
          "placement": {
            "constraints": [
              "node.role == manager"
            ]
          },
          "labels": [
            "traefik.enable=false"
          ]
        },
        "volumes": [
          {
            "type": "volume",
            "source": "hadoop-datavolume",
            "target": "/mnt/merlin",
            "volume": {
              "nocopy": true
            }
          },
          {
            "type": "volume",
            "source": "hadoop-logvolume",
            "target": "/mnt/logs",
            "volume": {
              "nocopy": true
            }
          }
        ]
      },
      "sparkworker": {
        "image": "docker-registry.parrot-rp.keyw:5000/hadoop-base-alpine:0.07.13",
        "environment": [
          "HADOOP_MACHINE_ROLE=sparkworker"
        ],
        "deploy": {
          "replicas": 1,
          "restart_policy": {
            "condition": "on-failure"
          },
          "placement": {
            "constraints": [
              "node.role == manager"
            ]
          },
          "labels": [
            "traefik.enable=false"
          ]
        },
        "volumes": [
          {
            "type": "volume",
            "source": "hadoop-datavolume",
            "target": "/mnt/merlin",
            "volume": {
              "nocopy": true
            }
          },
          {
            "type": "volume",
            "source": "hadoop-logvolume",
            "target": "/mnt/logs",
            "volume": {
              "nocopy": true
            }
          }
        ]
      },
      "stagingserver": {
        "image": "docker-registry.parrot-rp.keyw:5000/hadoop-base-alpine:0.07.13",
        "environment": [
          "HADOOP_MACHINE_ROLE=stagingserver"
        ],
        "deploy": {
          "replicas": 1,
          "restart_policy": {
            "condition": "on-failure"
          },
          "placement": {
            "constraints": [
              "node.role == manager"
            ]
          },
          "labels": [
            "traefik.enable=false"
          ]
        },
        "volumes": [
          {
            "type": "volume",
            "source": "hadoop-datavolume",
            "target": "/mnt/merlin",
            "volume": {
              "nocopy": true
            }
          },
          {
            "type": "volume",
            "source": "hadoop-logvolume",
            "target": "/mnt/logs",
            "volume": {
              "nocopy": true
            }
          }
        ]
      }
    }
  },
  "workerHostCount": 0,
  "dockerMachineWorkerOptions": {
    "engineLabel": "role=worker"
  },
  "dockerMachineMasterOptions": {
    "engineLabel": "role=master"
  },
  "dockerMachineDriverOptions": {
    "driver": "virtualbox",
    "virtualboxCpuCount": 2,
    "virtualboxMemory": 8092,
    "engineInsecureRegistry": "docker-registry.parrot-rp.keyw:5000"
  }
}
